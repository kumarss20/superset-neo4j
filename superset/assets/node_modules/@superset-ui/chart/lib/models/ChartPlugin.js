"use strict";exports.__esModule=!0,exports.default=void 0;var _react=_interopRequireDefault(require("react")),_core=require("@superset-ui/core"),_ChartMetadataRegistrySingleton=_interopRequireDefault(require("../registries/ChartMetadataRegistrySingleton")),_ChartBuildQueryRegistrySingleton=_interopRequireDefault(require("../registries/ChartBuildQueryRegistrySingleton")),_ChartComponentRegistrySingleton=_interopRequireDefault(require("../registries/ChartComponentRegistrySingleton")),_ChartControlPanelRegistrySingleton=_interopRequireDefault(require("../registries/ChartControlPanelRegistrySingleton")),_ChartTransformPropsRegistrySingleton=_interopRequireDefault(require("../registries/ChartTransformPropsRegistrySingleton"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _inheritsLoose(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function IDENTITY(a){return a}var EMPTY={};/**
 * Loaders of the form `() => import('foo')` may return esmodules
 * which require the value to be extracted as `module.default`
 * */function sanitizeLoader(a){return function(){var b=a();return b instanceof Promise?b.then(function(a){return"default"in a&&a.default||a}):b}}var ChartPlugin=/*#__PURE__*/function(a){function b(b){var c;c=a.call(this)||this,_defineProperty(_assertThisInitialized(c),"controlPanel",void 0),_defineProperty(_assertThisInitialized(c),"metadata",void 0),_defineProperty(_assertThisInitialized(c),"loadBuildQuery",void 0),_defineProperty(_assertThisInitialized(c),"loadTransformProps",void 0),_defineProperty(_assertThisInitialized(c),"loadChart",void 0);var d=b.metadata,e=b.buildQuery,f=b.loadBuildQuery,g=b.transformProps,h=void 0===g?IDENTITY:g,i=b.loadTransformProps,j=b.Chart,k=b.loadChart,l=b.controlPanel,m=void 0===l?EMPTY:l;if(c.controlPanel=m,c.metadata=d,c.loadBuildQuery=f&&sanitizeLoader(f)||e&&sanitizeLoader(function(){return e})||void 0,c.loadTransformProps=sanitizeLoader(i||function(){return h}),k)c.loadChart=sanitizeLoader(k);else if(j)c.loadChart=function(){return j};else throw new Error("Chart or loadChart is required");return c}_inheritsLoose(b,a);var c=b.prototype;return c.register=function register(){var a=this.config.key,b=void 0===a?(0,_core.isRequired)("config.key"):a;return(0,_ChartMetadataRegistrySingleton.default)().registerValue(b,this.metadata),(0,_ChartComponentRegistrySingleton.default)().registerLoader(b,this.loadChart),(0,_ChartControlPanelRegistrySingleton.default)().registerValue(b,this.controlPanel),(0,_ChartTransformPropsRegistrySingleton.default)().registerLoader(b,this.loadTransformProps),this.loadBuildQuery&&(0,_ChartBuildQueryRegistrySingleton.default)().registerLoader(b,this.loadBuildQuery),this},c.unregister=function unregister(){var a=this.config.key,b=void 0===a?(0,_core.isRequired)("config.key"):a;return(0,_ChartMetadataRegistrySingleton.default)().remove(b),(0,_ChartComponentRegistrySingleton.default)().remove(b),(0,_ChartControlPanelRegistrySingleton.default)().remove(b),(0,_ChartTransformPropsRegistrySingleton.default)().remove(b),(0,_ChartBuildQueryRegistrySingleton.default)().remove(b),this},c.configure=function configure(b,c){return a.prototype.configure.call(this,b,c),this},b}(_core.Plugin);exports.default=ChartPlugin;