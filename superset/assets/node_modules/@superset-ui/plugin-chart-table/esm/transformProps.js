function _extends(){return _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_extends.apply(this,arguments)}/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */import getProcessColumnsFunction from"./processColumns";import getProcessMetricsFunction from"./processMetrics";import getProcessDataFunction from"./processData";var processColumns=getProcessColumnsFunction(),processMetrics=getProcessMetricsFunction(),processData=getProcessDataFunction(),DTTM_ALIAS="__timestamp";function transformData(a,b){var c=b.groupby,d=void 0===c?[]:c,e=b.metrics,f=void 0===e?[]:e,g=b.allColumns,h=void 0===g?[]:g,i=new Set([].concat(d,f,h).map(function(a){return a.label||a})),j=a;b.includeTime&&i.add(DTTM_ALIAS);// handle percentage columns.
var k=(b.percentMetrics||[]).map(function(a){return a.label||a});if(0<k.length){var l=a.reduce(function(a,b){var c=_extends({},a);return k.forEach(function(d){c[d]=(a[d]||0)+(b[d]||0)}),c},{});j=a.map(function(a){var b=_extends({},a);return k.forEach(function(a){b["%"+a]=0===l[a]?null:b[a]/l[a]}),b}),k.forEach(function(a){i.add("%"+a)})}// handle sortedby column
if(b.timeseriesLimitMetric){var m=b.timeseriesLimitMetric.label||b.timeseriesLimitMetric;i.add(m)}return{columns:[].concat(i),records:j}}var NOOP=function(){};export default function transformProps(a){var b=a.height,c=a.width,d=a.datasource,e=a.initialValues,f=a.formData,g=a.hooks,h=a.queryData,i=g.onAddFilter,j=void 0===i?NOOP:i,k=f.alignPn,l=f.colorPn,m=f.includeSearch,n=f.metrics,o=f.orderDesc,p=f.pageLength,q=f.percentMetrics,r=f.tableFilter,s=f.tableTimestampFormat,t=f.timeseriesLimitMetric,u=transformData(h.data,f),v=u.records,w=u.columns,x=processMetrics({metrics:n,percentMetrics:q,records:v}),y=processData({metrics:x,orderDesc:o,records:v,timeseriesLimitMetric:t}),z=processColumns({columns:w,datasource:d,metrics:x,records:v,tableTimestampFormat:s});return{alignPositiveNegative:k,colorPositiveNegative:l,columns:z,data:y,filters:e,height:b,includeSearch:m,onAddFilter:j,orderDesc:o,pageLength:p&&parseInt(p,10),tableFilter:r,width:c}}