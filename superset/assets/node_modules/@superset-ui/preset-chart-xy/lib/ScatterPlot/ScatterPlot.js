"use strict";exports.__esModule=!0,exports.default=void 0;var _propTypes=_interopRequireDefault(require("prop-types")),_react=_interopRequireWildcard(require("react")),_xyChart=require("@data-ui/xy-chart"),_theme=require("@data-ui/theme"),_chartComposition=require("@superset-ui/chart-composition"),_Encoder=_interopRequireDefault(require("./Encoder")),_createMarginSelector=_interopRequireWildcard(require("../utils/selectors/createMarginSelector")),_DefaultTooltipRenderer=_interopRequireDefault(require("./DefaultTooltipRenderer")),_convertScaleToDataUIScaleShape=_interopRequireDefault(require("../utils/convertScaleToDataUIScaleShape")),_ChannelDef=require("../encodeable/types/ChannelDef"),_createXYChartLayoutWithTheme=_interopRequireDefault(require("../utils/createXYChartLayoutWithTheme")),_createEncoderSelector=_interopRequireDefault(require("../encodeable/createEncoderSelector")),_createRenderLegend=_interopRequireDefault(require("../components/legend/createRenderLegend"));function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _inheritsLoose(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var defaultProps={className:"",margin:_createMarginSelector.DEFAULT_MARGIN,theme:_theme.chartTheme,TooltipRenderer:_DefaultTooltipRenderer.default},ScatterPlot=/*#__PURE__*/function(a){function b(b){var c;return c=a.call(this,b)||this,_defineProperty(_assertThisInitialized(c),"createEncoder",(0,_createEncoderSelector.default)(_Encoder.default)),_defineProperty(_assertThisInitialized(c),"createMargin",(0,_createMarginSelector.default)()),c.renderChart=c.renderChart.bind(_assertThisInitialized(c)),c}_inheritsLoose(b,a);var c=b.prototype;return c.renderChart=function renderChart(a){var b=a.width,c=a.height,d=this.props,e=d.data,f=d.margin,g=d.theme,h=d.TooltipRenderer,i=this.createEncoder(this.props),j=i.channels;if("undefined"!=typeof j.x.scale){var q=j.x.getDomain(e);j.x.scale.setDomain(q)}if("undefined"!=typeof j.y.scale){var r=j.y.getDomain(e);j.y.scale.setDomain(r)}if((0,_ChannelDef.isScaleFieldDef)(j.size.definition)&&"quantitative"===j.size.definition.type){var k=j.size.getDomain(e),l=k[0],m=k[1],n=[Math.min(l||0,0),Math.max(m||1,1)];j.size.scale.setDomain(n)}var o=e.map(function(a){return{x:j.x.get(a),y:j.y.get(a),size:j.size.encode(a),fill:j.fill.encode(a),stroke:j.stroke.encode(a),data:a}}),p=(0,_createXYChartLayoutWithTheme.default)({width:b,height:c,margin:this.createMargin(f),theme:g,xEncoder:j.x,yEncoder:j.y});return p.renderChartWithFrame(function(a){return _react.default.createElement(_xyChart.XYChart,{width:a.width,height:a.height,ariaLabel:"BoxPlot",margin:p.margin,renderTooltip:function renderTooltip(a){var b=a.datum;return _react.default.createElement(h,{datum:b,encoder:i})},showYGrid:!0,theme:g,xScale:(0,_convertScaleToDataUIScaleShape.default)(j.x.scale.config),yScale:(0,_convertScaleToDataUIScaleShape.default)(j.y.scale.config)},p.renderXAxis(),p.renderYAxis(),_react.default.createElement(_xyChart.PointSeries,{key:j.x.definition.field,data:o,fill:function fill(a){return a.fill},fillOpacity:.5,stroke:function stroke(a){return a.stroke},size:function size(a){return a.size}}))})},c.render=function render(){var a=this.props,b=a.className,c=a.data,d=a.width,e=a.height,f=this.createEncoder(this.props);return _react.default.createElement(_chartComposition.WithLegend,{className:"superset-chart-scatter-plot "+b,width:d,height:e,position:"top",renderLegend:(0,_createRenderLegend.default)(f,c,this.props),renderChart:this.renderChart})},b}(_react.PureComponent);exports.default=ScatterPlot,_defineProperty(ScatterPlot,"propTypes",{className:_propTypes.default.string,width:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.number]).isRequired,height:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.number]).isRequired,margin:_propTypes.default.any,data:_propTypes.default.any.isRequired,theme:_propTypes.default.any,TooltipRenderer:_propTypes.default.func}),_defineProperty(ScatterPlot,"defaultProps",defaultProps);