"use strict";exports.__esModule=!0,exports.getURIDirectory=getURIDirectory,exports.getExploreLongUrl=getExploreLongUrl;var _urijs=_interopRequireDefault(require("urijs")),_safeStringify=require("./safeStringify");function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var MAX_URL_LENGTH=8e3;function getURIDirectory(a,b){void 0===b&&(b="base");// Building the directory part of the URI
var c="/superset/explore/";return 0<=["json","csv","query","results","samples"].indexOf(b)&&(c="/superset/explore_json/"),c}function getExploreLongUrl(a,b,c,d){if(void 0===c&&(c=!0),void 0===d&&(d={}),!a.datasource)return null;var e=new _urijs.default("/"),f=getURIDirectory(a,b),g=e.search(!0);Object.keys(d).forEach(function(a){g[a]=d[a]}),g.form_data=(0,_safeStringify.safeStringify)(a),"standalone"===b&&(g.standalone="true");var h=e.directory(f).search(g).toString();if(!c&&h.length>MAX_URL_LENGTH){var i={datasource:a.datasource,viz_type:a.viz_type};return getExploreLongUrl(i,b,!1,{URL_IS_TOO_LONG_TO_SHARE:null})}return h}