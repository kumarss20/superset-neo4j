function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _inheritsLoose(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}/* eslint-disable react/jsx-handler-names */ /* eslint-disable jsx-a11y/click-events-have-key-events */ /* eslint-disable jsx-a11y/no-static-element-interactions */ /* eslint-disable no-negated-condition */ /* eslint-disable react/destructuring-assignment */ /* eslint-disable no-eq-null */ /* eslint-disable sort-keys */ /* eslint-disable react/forbid-prop-types */ /**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */import React from"react";import PropTypes from"prop-types";import Mousetrap from"mousetrap";import{t}from"@superset-ui/translation";import BootrapSliderWrapper from"./BootstrapSliderWrapper";import"./PlaySlider.css";var propTypes={start:PropTypes.number.isRequired,step:PropTypes.number.isRequired,end:PropTypes.number.isRequired,values:PropTypes.array.isRequired,onChange:PropTypes.func,loopDuration:PropTypes.number,maxFrames:PropTypes.number,orientation:PropTypes.oneOf(["horizontal","vertical"]),reversed:PropTypes.bool,disabled:PropTypes.bool,range:PropTypes.bool},defaultProps={onChange:function onChange(){},loopDuration:15e3,maxFrames:100,orientation:"horizontal",reversed:!1,disabled:!1,range:!0},PlaySlider=/*#__PURE__*/function(a){function b(b){var c;c=a.call(this,b)||this,c.state={intervalId:null};var d=b.end-b.start,e=Math.min(b.maxFrames,d/b.step),f=d/e;return c.intervalMilliseconds=b.loopDuration/e,c.increment=f<b.step?b.step:f-f%b.step,c.onChange=c.onChange.bind(_assertThisInitialized(c)),c.play=c.play.bind(_assertThisInitialized(c)),c.pause=c.pause.bind(_assertThisInitialized(c)),c.stepBackward=c.stepBackward.bind(_assertThisInitialized(c)),c.stepForward=c.stepForward.bind(_assertThisInitialized(c)),c.getPlayClass=c.getPlayClass.bind(_assertThisInitialized(c)),c.formatter=c.formatter.bind(_assertThisInitialized(c)),c}_inheritsLoose(b,a);var c=b.prototype;return c.componentDidMount=function componentDidMount(){Mousetrap.bind(["space"],this.play)},c.componentWillUnmount=function componentWillUnmount(){Mousetrap.unbind(["space"])},c.onChange=function onChange(a){this.props.onChange(a.target.value),null!=this.state.intervalId&&this.pause()},c.getPlayClass=function getPlayClass(){return null==this.state.intervalId?"fa fa-play fa-lg slider-button":"fa fa-pause fa-lg slider-button"},c.play=function play(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{var a=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:a})}},c.pause=function pause(){clearInterval(this.state.intervalId),this.setState({intervalId:null})},c.stepForward=function stepForward(){var a=this,b=this.props,c=b.start,d=b.end,e=b.step,f=b.values,g=b.disabled;if(!g){var h=Array.isArray(f)?f:[f,f+e],i=h.map(function(b){return b+a.increment}),j=i[1]>d?i[0]-c:0;this.props.onChange(i.map(function(a){return a-j}))}},c.stepBackward=function stepBackward(){var a=this,b=this.props,c=b.start,d=b.end,e=b.step,f=b.values,g=b.disabled;if(!g){var h=Array.isArray(f)?f:[f,f+e],i=h.map(function(b){return b-a.increment}),j=i[0]<c?d-i[1]:0;this.props.onChange(i.map(function(a){return a+j}))}},c.formatter=function formatter(a){if(this.props.disabled)return t("Data has no time steps");var b=a;return Array.isArray(a)?a[0]===a[1]&&(b=[a[0]]):b=[a],b.map(function(a){return new Date(a).toUTCString()}).join(" : ")},c.render=function render(){var a=this.props,b=a.start,c=a.end,d=a.step,e=a.orientation,f=a.reversed,g=a.disabled,h=a.range,i=a.values;return React.createElement("div",{className:"play-slider"},React.createElement("div",{className:"play-slider-controls padded"},React.createElement("i",{className:"fa fa-step-backward fa-lg slider-button ",onClick:this.stepBackward}),React.createElement("i",{className:this.getPlayClass(),onClick:this.play}),React.createElement("i",{className:"fa fa-step-forward fa-lg slider-button ",onClick:this.stepForward})),React.createElement("div",{className:"play-slider-scrobbler padded"},React.createElement(BootrapSliderWrapper,{value:h?i:i[0],range:h,formatter:this.formatter,change:this.onChange,min:b,max:c,step:d,orientation:e,reversed:f,disabled:g?"disabled":"enabled"})))},b}(React.PureComponent);export{PlaySlider as default};PlaySlider.propTypes=propTypes,PlaySlider.defaultProps=defaultProps;