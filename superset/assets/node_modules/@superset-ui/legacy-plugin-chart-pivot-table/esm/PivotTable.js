/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */ /* eslint-disable sort-keys, no-magic-numbers, babel/no-invalid-this, babel/new-cap */import dt from"datatables.net-bs";import PropTypes from"prop-types";import{formatNumber}from"@superset-ui/number-format";import fixTableHeight from"./utils/fixTableHeight";import"datatables.net-bs/css/dataTables.bootstrap.css";window.$&&dt(window,window.$);var $=window.$||dt.$,propTypes={data:PropTypes.shape({// TODO: replace this with raw data in SIP-6
html:PropTypes.string,columns:PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]))}),height:PropTypes.number,columnFormats:PropTypes.objectOf(PropTypes.string),numberFormat:PropTypes.string,numGroups:PropTypes.number,verboseMap:PropTypes.objectOf(PropTypes.string)};function PivotTable(a,b){var c=b.data,d=b.height,e=b.columnFormats,f=b.numberFormat,g=b.numGroups,h=b.verboseMap,i=c.html,j=c.columns,k=a,l=$(a);k.innerHTML=i;var m=Array.isArray(j[0])?j.map(function(a){return a[0]}):j,n=function(){var a=$(this)[0].textContent;$(this)[0].textContent=h[a]||a};// jQuery hack to set verbose names in headers
if(l.find("thead tr:first th").each(n),l.find("thead tr th:first-child").each(n),l.find("tbody tr").each(function(){$(this).find("td").each(function(a){var b=m[a],c=e[b]||f||".3s",d=$(this)[0].textContent;Number.isNaN(d)||""===d||"null"===d.trim().toLowerCase()||($(this)[0].textContent=formatNumber(c,d),$(this).attr("data-sort",d))})}),1===g){k.style.overflow="hidden";var o=l.find("table").DataTable({paging:!1,searching:!1,bInfo:!1,scrollY:d+"px",scrollCollapse:!0,scrollX:!0});o.column("-1").order("desc").draw(),fixTableHeight(l.find(".dataTables_wrapper"),d)}else// When there is more than 1 group by column we just render the table, without using
// the DataTable plugin, so we need to handle the scrolling ourselves.
// In this case the header is not fixed.
k.style.overflow="auto",k.style.height=d+10+"px"}PivotTable.displayName="PivotTable",PivotTable.propTypes=propTypes;export default PivotTable;